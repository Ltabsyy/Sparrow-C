Sparrow C滚动条构想

Sparrow C是一款由Ltabsyy、Jws构想，尚未实现的全新IDE。
其支持C和C++编程语言，支持Windows、macOS、Linux、Android、iOS、iPadOS、visionOS。
在不同的平台上，具有截然不同的设计。

(1)基本思想
我们的滚动条，是一种
兼顾全局预览、局部预览、行数定位、行级微颤，
具有像素级非线性过渡动画，
支持短代码与无限长代码，
完美支持鼠标、触摸板、触屏和摇杆，支持混合现实空间
的文本定位交互控件。

(2)隐藏
当页面高度足以显示文件的所有行时，行滚动条隐藏，行滚动交互不可进行；
当当前已显示页面宽度足以显示文件所有行中最大列时，列滚动条隐藏，列滚动交互不可进行。

(3)左上整字符约束
我们的编辑器页面，其顶部不会在非整行像素停留，当前页面第一行除过渡动画外总是恰好显示完整的行，不会出现半行显示。
其左部不会在使所有行首字符都为非整列像素的位置停留，
对于全半角字符、非整列字体，均计算最左侧位置，形成该行的约束位置，当前页面所有行的约束位置构成当前页面约束位置的集合，
我们的编辑器页面，其左部不会在非当前页面约束位置停留，仅在过渡动画时处于非约束位置状态。

(4)行与列滚动条的位置
行滚动条显示在编辑器页面右侧，列滚动条显示在编辑器页面底部。
行滚动条的上下箭头按钮均位于行滚动条下侧，列滚动条的左右箭头按钮均位于列滚动条右侧。
对于右下角空间，行滚动条优先于列滚动条显示。

(5)行滚动条左侧的红绿条
对于相对已保存文件修改的行，其对应的滚动条位置，左侧以红条显示。
对于打开时文件修改并已保存的行，其对应的滚动条位置，左侧以绿条显示。
当使用文本对比功能时，新文件相对原文件，删除的行为红，新增的行为绿，修改的行为黄。
不显示红绿条的滚动条位置，左侧以灰条显示。

(6)行滚动条内的全局彩色显示
对于经过彩色高亮的代码，不含左侧列号，增补右侧列号，进行缩小，显示在滚动条内。
行数较多时，其字符所占的所有空间以字符前景色填充，行数较少时，不进行处理。
行滚动条不存在边界线，以左红绿条右缩小列号作为假想边界。

(7)短与长文件
设定行滚动条的最大宽度，当显示的内容高度不足页面高度时，剩余部分不属于行滚动条，显示文本。
当显示的内容高度超过页面高度时，内容整体进行缩小，红绿条不缩小宽度，仅缩小高度。
对任意长文件，均作此处理，即使内容已无法看清，保持红绿条至少为1像素点高度。

(8)目标跳转
当鼠标悬浮在滚动条上时，确定对应位置为目标页面，点击即可跳转。
当行滚动条的高度不足页面高度时，以鼠标在行滚动条的绝对位置为中心，上下半页面高度确定目标页面。
当行滚动条的高度超过页面高度时，以鼠标在行滚动条的相对位置为中心，下整页面高度确定目标页面。

(9)框选显示
滚动条的一段连续内容可被框选，框包括左红绿条右缩小列号，框内背景进行一定的高亮，前景不作处理。
当前页面被蓝色框选，目标页面被黄色框选。
框实际高度过小时，至少显示为可点击的高度，此时均不保持顶部与底部位置准确，仅保持相对位置准确。

(10)悬浮局部预览
当鼠标悬浮在行滚动条上时，在行滚动条左侧显示预览框，
预览框包含以红绿条为背景的左侧列号、经过彩色高亮的代码、右侧列号。
预览框内容即目标页面，当鼠标上下移动时，预览框也随之移动。

(11)局部预览的行级微颤
当预览框显示时，鼠标可左移悬浮至预览框之上，此时鼠标对应的预览框行高亮显示，点击可跳转到以该行为第一行的目标页面。
当预览框显示的目标页面并不位于文件最上或最下位置时，
鼠标悬浮在预览框第一行或最后一行，可缓慢上移或下移一行。
上下拨动滚轮时，以设定行数为单位上下移动预览框。

(12)跳转与微颤的过渡动画
通过滚动条引起的页面跳转、滚动条蓝色框选移向黄色框选、预览框显示与隐藏、预览框行级微颤，均使用过渡动画。
过渡动画为像素级，而不是行级，为非线性而不是线性，速度先增后减。过渡动画均在一秒内完成。
页面跳转具有类似快速翻页的过渡动画，无论跳转距离多远，过渡动画均在一秒内完成。
此时，滚动条蓝色框选同步移向黄色框选，在动画的中间过程，框选位置保持严格对应。
预览框由隐藏转为显示时，出现由透明非线性转向不透明，非线性移向最终位置的过渡动画。
预览框由显示转为隐藏时，出现与隐藏转为显示时反向的过渡动画。
预览框跟随鼠标移动时，黄色框选立即跟随鼠标，预览框内容出现页面跳转的过渡动画。
预览框行级微颤时，出现较慢的过渡动画。

(13)触屏与摇杆
触摸板交互与鼠标相同。
触屏不可通过点击滚动条进行目标跳转，点击为显示预览框，点击预览框才可跳转。
显示预览框时，点击或拖动滚动条为调整目标页面位置，点击除滚动条和预览框的其他部分即隐藏预览框。
摇杆上下移动，从蓝色框选位置开始出现黄色框选，摇杆操控黄色框选的移动，与此同时直接出现预览框。
摇杆左右移动可切换在滚动条处移动或是在预览框处移动。无论在何处，按键即可跳转对应位置。

(14)混合现实空间
当眼球注视滚动条时，立即显示预览框，当眼球注视滚动条和预览框外的其他部分3秒，隐藏预览框。
当眼球注视预览框时，保持绝对位置不变，保持注视位置周围总出现内容，注视行高亮，此时捏合手指即可跳转。
